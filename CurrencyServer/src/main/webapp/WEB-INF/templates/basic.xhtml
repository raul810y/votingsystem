<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <ui:insert name="head" />
</h:head>
<h:body>
    <div id="voting_system_page">
        <ui:insert name="content"/>
    </div>
    <script>
        document.querySelector("#voting_system_page").addEventListener('message_from_extension',
                function(event) {
                    vs.webextension_available = true
                    Polymer.Base.importHref(vs.contextURL + '/resources/bower_components/vs-block-screen/vs-block-screen.vsp', function(e) {
                        var blockScreen = document.createElement('vs-block-screen');
                        document.querySelector("body").appendChild(blockScreen)
                        vs.blockScreen = blockScreen.block.bind(blockScreen)
                        var operationVS = new OperationVS(Operation.INIT_SERVER)
                        operationVS.serverURL = vs.contextURL
                        VotingSystemClient.setMessage(operationVS);
                    });
                    document.querySelector("#voting_system_page").addEventListener("message_from_webextension:dialog_closed", function(e) {
                        vs.blockScreen(false)
                    });
                })
    </script>
</h:body>
</html>
