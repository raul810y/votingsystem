<html>
<script src="./bower_components/visionmedia-page/page.js"></script>
<script>
  window.addEventListener('WebComponentsReady', function() {

      function scrollToTop(ctx, next) {
          vs.scrollPageToTop();
          next();
      }

      var contactPage
      page('*/app/contact', scrollToTop, function (ctx) {
          vs.route = 'contact';
          Polymer.Base.importHref('./app/contact-page.vsp', function(e) {
              if(!contactPage) contactPage = document.createElement('contact-page');
              vs.loadMainContent(contactPage, "${msg.contactLbl}")
          });
      });

      var toolsPage
      page('*/app/tools', scrollToTop, function (ctx) {
          vs.route = 'tools';
          Polymer.Base.importHref('./app/tools-page.vsp', function(e) {
              if(!toolsPage) toolsPage = document.createElement('tools-page');
              vs.loadMainContent(toolsPage, "${msg.toolsPageTitle}")
          });
      });

      var eventElectionList
      page('*/eventElection', scrollToTop, function (ctx) {
          vs.route = 'eventElection';
          Polymer.Base.importHref('./eventElection/eventvs-election-list.vsp', function () {
              if (!eventElectionList) eventElectionList = document.createElement('eventvs-election-list');
              eventElectionList.loadURL(ctx.path, ctx.querystring)
              vs.loadMainContent(eventElectionList, "${msg.electionSystemLbl}")
          });
      });

      var eventElection
      page('/rest/eventElection/id*', scrollToTop, function (ctx) {
          vs.route = 'eventElection';
          Polymer.Base.importHref('./eventElection/eventvs-election.vsp', function () {
              if (!eventElection) eventElection = document.createElement('eventvs-election');
              if(vs.eventvs) eventElection.eventvs = vs.eventvs
              else eventElection.url = vs.contextURL + ctx.path
              vs.loadMainContent(eventElection, "${msg.pollLbl}")
          });
      });

      var representativePage
      page('/rest/representative/id*', scrollToTop, function (ctx) {
          vs.route = 'representative';
          Polymer.Base.importHref('./representative/representative-info.vsp', function () {
              if (!representativePage) representativePage = document.createElement('representative-info');
              if(vs.representative) representativePage.representative = vs.representative
              else representativePage.url = vs.contextURL + ctx.path
              vs.loadMainContent(representativePage, "${msg.representativeLbl}")
          });
      });

      var representativeEditor
      page('/representative/edit', scrollToTop, function (ctx) {
          vs.route = 'edit_representative';
          Polymer.Base.importHref('./representative/representative-editor.vsp', function () {
              if (!representativeEditor) representativeEditor = document.createElement('representative-editor');
              vs.loadMainContent(representativeEditor, "${msg.newRepresentativeLbl}")
          });
      });

      var eventvsEditor
      page('/publish_election', scrollToTop, function (ctx) {
          vs.route = 'publish_election';
          Polymer.Base.importHref('./eventElection/eventvs-editor.vsp', function () {
              if (!eventvsEditor) eventvsEditor = document.createElement('eventvs-editor');
              vs.loadMainContent(eventvsEditor, "${msg.publishVoteLbl}")
          });
      });

      var representativeList
      page('*/representative', scrollToTop, function (ctx) {
          vs.route = 'representative';
          Polymer.Base.importHref('./representative/representative-list.vsp', function () {
              if (!representativeList) representativeList = document.createElement('representative-list');
              vs.loadMainContent(representativeList, "${msg.representativesPageLbl}")
          });
      });

      var feedsPage
      page('*/subscriptionVS/feeds', scrollToTop, function (ctx) {
          vs.route = 'feeds';
          Polymer.Base.importHref('./subscriptionVS/feeds-page.vsp', function(e) {
              if(!feedsPage) feedsPage = document.createElement('feeds-page');
              vs.loadMainContent(feedsPage, "${msg.subscriptionLbl}")
          });
      });

      page({
          hashbang: true // add #! before urls
      });

      if(!vs.route) page("/eventElection")
  })
</script>
</html>